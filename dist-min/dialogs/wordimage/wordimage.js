/*! UEditorPlus v2.0.0*/
function addUploadButtonListener(){g("saveFile").addEventListener("change",function(){if(1!==this.files.length)return void alert("请选择1个文件");$(".image-tip").html("正在转存，请稍后...");var a=this.files[0];if(editor.getOpt("uploadFile")){var b=editor.getOpt("uploadFile");return void b(a).then(function(b){b.url?(window.imageUrls.push({name:a.name,url:b.url,title:""}),$("#fileUrl").val().indexOf(a.name)>=0?($("#fileUrl").val(b.url),$(".image-tip").html('<span style="color:#139213;">转存成功，请提交确认</span>')):($("#fileUrl").val(b.url),$(".image-tip").html('<span style="color:#139213;">上传成功，请提交确认</span>'))):$(".image-tip").html("上传失败:"+JSON.stringify(b))})["catch"](function(a){$(".image-tip").html("上传失败:"+JSON.stringify(a))})}uploader.addFile(a),uploader.upload()})}function addOkListener(){dialog.onok=function(){if(imageUrls.length){var a=editor.getOpt("imageUrlPrefix")||"",b=domUtils.getElementsByTagName(editor.document,"img");editor.fireEvent("saveScene");for(var c,d=0;c=b[d++];){var e=c.getAttribute("data-word-image");if(e)for(var f,g=0;f=imageUrls[g++];){c.src=a+f.url,c.setAttribute("_src",a+f.url),c.setAttribute("title",f.title),domUtils.removeAttributes(c,["data-word-image","style","width","height"]),editor.fireEvent("selectionchange");break}}editor.fireEvent("saveScene")}},dialog.oncancel=function(){}}function showLocalPath(a){var b=editor.selection.getRange().getClosedNode(),c=editor.execCommand("wordimage");if(1==c.length||b&&"IMG"==b.tagName)return void(g(a).value=c[0]);var d=c[0],e=d.lastIndexOf("/")||0,f=d.lastIndexOf("\\")||0,h=e>f?"/":"\\";d=d.substring(0,d.lastIndexOf(h)+1),g(a).value=d}function createCopyButton(a,b){var c=g(b).value;c.startsWith("file:////")&&(c=c.substring(8)),g(a).setAttribute("data-clipboard-text",c);var d=new Clipboard("[data-clipboard-text]");d.on("success",function(a){g("copyButton").innerHTML="复制成功"})}var wordImage={},g=$G,flashObj,flashContainer;wordImage.init=function(a,b){showLocalPath("fileUrl"),createCopyButton("copyButton","fileUrl"),addUploadButtonListener(),addOkListener()};